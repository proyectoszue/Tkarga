<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record model="ir.actions.act_window"  id="mntc_tasks_action">
            <field name="name">Tasks</field>
            <field name="res_model">mntc.tasks</field>
            <field name="view_mode">tree,form,calendar,dashboard</field>
		</record>

        <record model="ir.ui.view" id="zue_fleet_maintenance.list_mntc_tasks_action">
            <field name="name">zue mntc tasks</field>
            <field name="model">mntc.tasks</field>
            <field name="arch" type="xml">
                <tree string="mntc tasks tree">
                    <field name="garage_id"/>
                    <field name="vehicle_id"/>
                    <field name="movil_nro"/>
                    <field name="service_type_id"/>
                    <field name="brand_id"/>
                    <field name="vehiculo_linea_id"/>
                    <field name="disponibilidad"/>
                    <field name="workorder_id"/>
                    <field name="routine_id"/>
                    <field name="activity_id"/>
                    <field name="name"/>
                    <field name="system_id"/>
                    <field name="symptom_ids"/>
                    <field name="detection_method"/>
                    <field name="estimated_time" widget="float_time"/>
                    <field name="spent_time" widget="float_time"/>
                    <field name="start_executed_date"/>
                    <field name="tasks_cost"/>
                    <field name="program_cost"/>
                    <field name="program_cost_supplier"/>
                    <field name="request_id"/>
                    <field name="type_mntc"/>
                    <field name="priority"/>
                    <field name="location_id"/>
                    <field name="classification1"/>
                    <field name="component_id"/>
                    <field name="fail_spare_id"/>
                    <field name="cause_id"/>
                    <field name="action_taken_id"/>
                    <field name="spare_part_ids"/>                    
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="mntc_tasks_form">
            <field name="name">mntc.tasks.form</field>
            <field name="model">mntc.tasks</field>
            <field name="arch" type="xml">
                <form string="Mntc tasks form">
                    <header>
                        <field name="state" widget="statusbar" clickable="1"   attrs="{'readonly': [('state','not in', ['started'])]}"/>
                    </header>
                    <sheet string="tasks">
                        <div class="oe_right oe_button_box" name="buttons">
                            <!-- <button name="return_action_to_open_spare_parts" class="oe_inline oe_stat_button"
                                    context="{'xml_id':'list_mntc_spare_part_x_task_action', 'vehicle_id': vehicle_id, 'task_id': id}"
                                    icon="fa-list" type="object">
                                    <field name="counter_spare_parts" widget="statinfo"/>
                            </button> -->
                        </div>
                        <group>
                            <label for="name"/>
                            <h1>
                                <field name="name"/>
                            </h1>
                        </group>
                        <group>
                            <field name="process_description"/>
                        </group>
                        <group>
                            <group>
                                <field name="workorder_id" readonly="1"/>
                                <field name="routine_id"/>
                                <field name="activity_id"/>
                            </group>
                            <group>
                                <field name="system_id"/>
                                <field name="vehicle_id" readonly="1"/>
                                <field name="movil_nro" readonly="1"/>
                            </group>
                        </group>
                         <group>
                             <group>
                                 <field name="estimated_time" widget="float_time" readonly='0'/>
                                 <field name="start_programmed_date"/>
                                 <field name="end_programmed_date"/>
                            </group>
                           <group>
                                <field name="spent_time"  widget="float_time"/> 
                                <field name="start_executed_date" attrs="{'readonly': [('workorder_state','not in', ['in_progress'])]}"/>
                                <field name="end_executed_date" attrs="{'readonly': [('workorder_state','not in', ['in_progress'])]}"/>
                            </group>
                        </group>
                        <group>
                            <field name="workorder_state" invisible='1' readonly='1'/>
                        </group>
                        <notebook>
                            <page string="Executed inspections"> 
                                <field name="executed_inspections_ids" can_create="false" can_write="true">
                                    <tree editable="bottom" string="Executed inspections"> 
                                        <field name="name"/>
                                        <field name="sequence"/>
                                        <field name="inspection_type"/>
                                        <field name="inspection_id" invisible="1"/>
                                        <field name="executed_inspection_answer_id"/>
                                        <field name="quantitative_value"/>
                                        <field name="ok"/>
                                        <field name="not_apply"/>
                                        <field name="description" attrs="{'required': ['|',('not_apply', '=', True),('ok', '=', False)]}"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Repuestos"> 
                                <field name="repuesto"/>
                            </page>
                            <page string="Servicios"> 
                                <field name="servicio"/>
                            </page>
                            <page string="Recurso humano (planeado)" attrs="{'invisible': [('workorder_state','not in', ['planeacion','programmed'])]}">
                                <field name="disciplina_rh" widget="one2many"> 
                                    <tree editable="bottom">
                                        <field name="workforce_type_id" required="1"/>
                                        <!-- <field name="code"/>
                                        <field name="description"/> -->
                                        <field name="start_programmed_date"/>
                                        <field name="end_programmed_date"/>
                                        <field name="programmed_time" widget="float_time"/>
                                        <field name="task_id" invisible="1"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="EjecuciÃ³n" attrs="{'invisible': [('workorder_state','not in', ['in_progress','ended'])]}">
                                <notebook>
                                    <page string="Recurso Humano">
                                        <field name="disciplina_ejecutada_rh" widget="one2many">
                                            <tree editable="bottom">
                                                <field name="workforce_type_id" required="1"/>
                                                <!-- <field name="code"/>
                                                <field name="description"/>  -->
                                                <field name="technician_id"/>
                                                <field name="res_partner_id"/>
                                                <field name="start_executed_date"/>
                                                <field name="end_executed_date"/>
                                                <field name="spent_time" widget="float_time"/>
                                                <field name="task_id" invisible="1"/>
                                            </tree>
                                        </field>
                                    </page>
                                    <page string="Datos de cierre">
                                        <group>
                                            <field name="system_id"/>
                                            <field name="component_id"/>
                                            <field name="component_ids" invisible="1"/>                                            
                                            <field name="spare_part_type_id"/>
                                        </group>
                                        <group>
                                            <field name="cause_id"/>
                                            <field name="action_taken_id"/>
                                            <field name="process_description_programm"/> 
                                        </group>
                                    </page>
                                    <page string="Costos">
                                        <group>
                                            <field name="inspection_ok"/>
                                        </group>
                                        <group>
                                            <field name="tasks_cost"/>
                                            <field name="program_cost"/>
                                            <field name="program_cost_supplier"/>
                                        </group>
                                    </page>
                                </notebook>
                            </page>
                        </notebook>
                        <separator/>
                        <group>
                            <field name="required_technicians"/>  
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="mntc_tasks_graph" model="ir.ui.view">
            <field name="name">mntc.tasks.graph</field>
            <field name="model">mntc.tasks</field>
            <field name="arch" type="xml">
                <graph string="Graph">
                    <field name="estimated_time" type="measure" widget="float_time"/>
                    <field name="spent_time" type="measure" widget="float_time"/>
                </graph>
            </field>
		</record>

        <record id="mntc_tasks_pivot" model="ir.ui.view">
            <field name="name">mntc.tasks.pivot</field>
            <field name="model">mntc.tasks</field>
            <field name="arch" type="xml">
                <pivot string="Pivot">
                    <field name="estimated_time" type="measure" widget="float_time"/>
                    <field name="spent_time" type="measure" widget="float_time"/>
                </pivot>
            </field>
		</record>

        <record id="mntc_tasks_dashboard" model="ir.ui.view">
            <field name="name">mntc.tasks.dashboard</field>
            <field name="model">mntc.tasks</field>
            <field name="arch" type="xml">
                <dashboard>
                    <view type="pivot" ref="zue_fleet_maintenance.mntc_tasks_pivot"/>
                    <view type="graph" ref="zue_fleet_maintenance.mntc_tasks_graph"/>
                </dashboard>
            </field>
		</record>

        <record  model="ir.ui.view" id="mntc_tasks_calendar">
            <field name="name">mntc.tasks.calendar</field>
            <field name="model">mntc.tasks</field>
            <field name="arch" type="xml">
                <calendar date_start="start_programmed_date" color="workorder_id">
                    <field name="workorder_id" />
                    <field name="activity_id"  />
                </calendar>
            </field>
        </record>

        <!-- <record id="mntc_tasks_gantt" model="ir.ui.view">
            <field name="name">mntc.tasks.gantt</field>
            <field name="model">mntc.tasks</field>
             <field name="arch" type="xml">
                <gantt date_start="start_programmed_date" date_delay="estimated_time"/>
             </field>
        </record> -->

        <record id="mntc_tasks_search" model="ir.ui.view">
            <field name="name">mntc.tasks.search</field>
            <field name="model">mntc.tasks</field>
            <field name="arch" type="xml">
                <search string="Tasks">
                    <field name="garage_id"/>
                    <field name="workorder_id"/>
                    <field name="routine_id"/>
                    <field name="activity_id"/>
                    <field name="system_id"/>
                    <field name="state"/>
                    <field name="vehicle_id"/>
                    <field name="movil_nro"/>
                    <field name="component_id"/>
                    <field name="fail_spare_id"/>
                    <field name="cause_id"/>
                    <field name="action_taken_id"/>
                    <field name="symptom_ids"/>
                    <field name="detection_method"/>
                    <field name="service_type_id"/>
                    <field name="brand_id"/>
                    <field name="vehiculo_linea_id"/>
                    <field name="disponibilidad"/>
                    <group expand="0" string="Group By">
                        <filter string="Garage" name= "garage_id" context="{'group_by':'garage_id'}"/>
                        <filter string="Vehicle" name= "vehicle_id" context="{'group_by':'vehicle_id'}"/>
                        <filter string="Movil" name= "movil_nro" context="{'group_by':'movil_nro'}"/>
                        <filter string="Workorder" name= "workorder_id" context="{'group_by':'workorder_id'}"/>
                        <filter string="Routine" name= "routine_id" context="{'group_by':'routine_id'}"/>
                        <filter string="Activity" name= "activity_id" context="{'group_by':'activity_id'}"/>
                        <!-- <filter string="System" name= "system_id" context="{'group_by':'system_id'}"/> -->
                        <!-- <filter string="Base Symptom" name= "base_symptoms_id" context="{'group_by':'base_symptoms_id'}"/> -->
                        <filter string="Maintenance Type" name= "type_mntc" context="{'group_by':'type_mntc'}"/>
                        <filter string="Priority" name= "priority" context="{'group_by':'priority'}"/>
                        <filter string="Request" name= "request_id" context="{'group_by':'request_id'}"/>
                        <filter string="Location" name= "location_id" context="{'group_by':'location_id'}"/>
                        <filter string="classification" name= "classification1" context="{'group_by':'classification1'}"/>
                        <!-- <filter string="Component" name= "component_id" context="{'group_by': 'component_id'}"/> -->
                        <filter string="Fail Spare" name= "fail_spare_id" context="{'group_by':'fail_spare_id'}"/>
                        <filter string="Cause" name= "cause_id" context="{'group_by':'cause_id'}"/>
                        <filter string="Action Taken" name= "action_taken_id" context="{'group_by':'action_taken_id'}"/>
                        <filter string="State" name= "state" context="{'group_by':'state'}"/>
                        <filter string="Start programmed date" name= "start_programmed_date" context="{'group_by':'start_programmed_date'}"/>
                        <filter string="Symptom" name= "symptom_ids" context="{'group_by':'symptom_ids'}"/>
                        <filter string="Detection method" name= "detection_method" context="{'group_by':'detection_method'}"/>
                        <filter string="Service type" name= "service_type_id" context="{'group_by':'service_type_id'}"/>
                        <filter string="Brand" name= "brand_id" context="{'group_by':'brand_id'}"/>
                        <filter string="vehiculo linea" name= "vehiculo_linea_id" context="{'group_by':'vehiculo_linea_id'}"/>
                        <filter string="Disponibilidad" name= "disponibilidad" context="{'group_by':'disponibilidad'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.actions.act_window"  id="mntc_executed_inspections_action">
            <field name="name">Executed inspections</field>
            <field name="res_model">mntc.executed.inspections</field>
            <field name="view_mode">tree,form</field>
		</record>

        <record model="ir.ui.view" id="mntc_executed_inspections_tree_view">
            <field name="name">mntc.executed.inspections.tree.view</field>
            <field name="model">mntc.executed.inspections</field>
            <field name="arch" type="xml">
                <tree editable="bottom" string="Executed inspections" create="false" > 
                    <field name="name"/>
                    <field name="sequence"/>
                    <field name="inspection_type"/>
                    <field name="inspection_id" invisible="1"/>
                    <field name="executed_inspection_answer_id"/>
                    <field name="quantitative_value"/>
                    <field name="ok"/>
                    <field name="not_apply"/>
                    <field name="description" attrs="{'required': ['|',('not_apply', '=', True),('ok', '=', False)]}"/>
                </tree>
            </field>
        </record>

    </data>
</odoo>
